import os
from pathlib import Path
import pandas as pd
import dicom2nifti

# input_path = 'F:/test_nifti/input'
# output_path = 'F:/test_nifti/output'
# source_path = 'F:/test_nifti/P302.070610/1.3.6.1.4.1.3167252.49.50.48.53.57.50.55.50.1638435799793.91/'
# destin_path = 'F:/test_nifti/output/P302.070610/'

# dicom2nifti.convert_directory(source_path, destin_path, compression=False, reorient=True)

# dicom2nifti.dicom_series_to_nifti(source_path, destin_path, reorient_nifti=True)
source_path = ['J:/1-5 Anonyme/2021/07/P302.052035/1.3.6.1.4.1.3167249.48.48.50.48.51.52.52.57.1626561885781.84',
'J:/1-5 Anonyme/2021/07/P302.052308/1.3.6.1.4.1.3167249.48.49.50.50.57.56.48.52.1626682538527.74',
'J:/1-5 Anonyme/2021/07/P302.050625/1.3.6.1.4.1.3167249.48.49.57.50.53.48.56.53.1626797227004.85',
'J:/1-5 Anonyme/2021/07/P302.052875/1.3.6.1.4.1.3167249.48.50.53.55.54.49.52.53.1626807564054.45',
'J:/1-5 Anonyme/2021/07/P302.048539/1.3.6.1.4.1.3167249.48.55.54.48.54.50.52.51.1625431183894.53',
'J:/1-5 Anonyme/2021/07/P302.052419/1.3.6.1.4.1.3167249.49.49.54.55.52.56.51.50.1626698434181.62',
'J:/1-5 Anonyme/2021/07/P302.052646/1.3.6.1.4.1.3167249.49.54.55.52.57.51.55.49.1626740381071.30',
'J:/1-5 Anonyme/2021/07/P302.056269/1.3.6.1.4.1.3167249.50.57.54.57.54.52.51.55.1627658741750.77',
'J:/1-5 Anonyme/2021/07/P302.053220/1.3.6.1.4.1.3167249.51.55.48.53.55.55.52.1626879291151.191',
'J:/1-5 Anonyme/2021/07/P302.052580/1.3.6.1.4.1.3167249.51.55.53.51.55.55.53.56.1626879221302.40',
'J:/1-5 Anonyme/2021/07/P302.048722/1.3.6.1.4.1.3167249.52.48.53.49.53.53.57.57.1625502118926.69',
'J:/1-5 Anonyme/2021/07/P302.048563/1.3.6.1.4.1.3167249.52.49.56.49.50.56.53.51.1625436572642.15',
'J:/1-5 Anonyme/2021/07/P302.048477/1.3.6.1.4.1.3167249.54.57.51.49.52.48.56.49.1625414139969.23',
'J:/1-5 Anonyme/2021/07/P302.052757/1.3.6.1.4.1.3167249.55.53.54.55.48.51.50.49.1626790029118.77',
'J:/1-5 Anonyme/2021/07/P302.052551/1.3.6.1.4.1.3167249.57.48.56.54.56.49.54.55.1626722527315.56',
'J:/1-5 Anonyme/2021/07/P302.052231/1.3.6.1.4.1.3167249.57.53.50.55.49.55.48.55.1626633234840.19',
'J:/1-5 Anonyme/2021/07/P302.052772/1.3.6.1.4.1.3167249.57.54.49.53.52.56.55.50.1626792052683.33',
'J:/1-5 Anonyme/2021/07/P302.052964/1.3.6.1.4.1.3167249.57.57.55.52.54.55.56.57.1626820368251.20',
'J:/1-5 Anonyme/2021/07/P302.052156/1.3.6.1.4.1.3167250.48.48.48.57.53.50.50.49.1626615069567.19',
'J:/1-5 Anonyme/2021/07/P302.056072/1.3.6.1.4.1.3167250.48.49.56.55.50.51.48.56.1627600195653.33',
'J:/1-5 Anonyme/2021/07/P302.052215/1.3.6.1.4.1.3167250.48.54.50.50.52.48.57.54.1626885476266.41',
'J:/1-5 Anonyme/2021/07/P302.050015/1.3.6.1.4.1.3167250.48.54.54.51.48.54.49.48.1626563145140.82',
'J:/1-5 Anonyme/2021/07/P302.053177/1.3.6.1.4.1.3167250.48.56.53.50.48.54.50.55.1626874207405.22',
'J:/1-5 Anonyme/2021/07/P302.053181/1.3.6.1.4.1.3167250.49.49.50.55.52.48.54.55.1626885906587.78',
'J:/1-5 Anonyme/2021/07/P302.052707/1.3.6.1.4.1.3167250.49.53.48.52.57.49.50.55.1626779808466.61',
'J:/1-5 Anonyme/2021/07/P302.054890/1.3.6.1.4.1.3167250.49.53.49.49.54.52.53.53.1627768641086.54',
'J:/1-5 Anonyme/2021/07/P302.053307/1.3.6.1.4.1.3167250.49.55.52.53.53.48.55.53.1626894013425.37',
'J:/1-5 Anonyme/2021/07/P302.053258/1.3.6.1.4.1.3167250.50.48.53.55.54.49.56.53.1626890007368.50',
'J:/1-5 Anonyme/2021/07/P302.052152/1.3.6.1.4.1.3167250.50.50.48.56.50.48.48.54.1626613175693.14',
'J:/1-5 Anonyme/2021/07/P302.052902/1.3.6.1.4.1.3167250.50.52.56.49.56.50.54.49.1626811934703.88',
'J:/1-5 Anonyme/2021/07/P302.053305/1.3.6.1.4.1.3167250.52.48.53.51.49.57.57.48.1626893640907.44',
'J:/1-5 Anonyme/2021/07/P302.051924/1.3.6.1.4.1.3167250.52.53.48.55.50.55.52.48.1626545151297.93',
'J:/1-5 Anonyme/2021/07/P302.052566/1.3.6.1.4.1.3167250.52.55.54.57.53.52.53.55.1626726629016.21',
'J:/1-5 Anonyme/2021/07/P302.052742/1.3.6.1.4.1.3167250.53.48.53.48.57.50.57.52.1626786875008.51',
'J:/1-5 Anonyme/2021/07/P302.051230/1.3.6.1.4.1.3167250.53.50.48.56.49.53.54.54.1626887855396.83',
'J:/1-5 Anonyme/2021/07/P302.052866/1.3.6.1.4.1.3167250.53.51.51.54.57.54.50.50.1626806368819.56',
'J:/1-5 Anonyme/2021/07/P302.048575/1.3.6.1.4.1.3167250.53.52.49.53.56.51.48.57.1625443555627.86',
'J:/1-5 Anonyme/2021/07/P302.051038/1.3.6.1.4.1.3167250.53.55.57.49.48.56.48.54.1626511156993.31',
'J:/1-5 Anonyme/2020/05/P302.013322/1.3.6.1.4.1.3167250.54.48.52.57.57.56.55.50.1590858390584.78',
'J:/1-5 Anonyme/2021/07/P302.052159/1.3.6.1.4.1.3167250.54.57.54.53.54.56.48.48.1626615576017.56',
'J:/1-5 Anonyme/2021/07/P302.056435/1.3.6.1.4.1.3167250.55.48.57.53.56.55.51.56.1627729237509.27',
'J:/1-5 Anonyme/2021/07/P302.052185/1.3.6.1.4.1.3167250.55.52.49.57.53.54.50.54.1626622160129.86',
'J:/1-5 Anonyme/2021/07/P302.051887/1.3.6.1.4.1.3167250.55.52.54.50.50.49.49.48.1626540204518.92',
'J:/1-5 Anonyme/2021/07/P302.053043/1.3.6.1.4.1.3167250.56.51.55.54.54.57.56.57.1626859608147.55',
'J:/1-5 Anonyme/2020/05/P302.013225/1.3.6.1.4.1.3167250.56.53.54.49.55.53.49.53.1590749004526.36',
'J:/1-5 Anonyme/2021/07/P302.051958/1.3.6.1.4.1.3167250.56.55.51.56.54.57.56.57.1626549039765.27',
'J:/1-5 Anonyme/2021/07/P302.052092/1.3.6.1.4.1.3167250.57.49.56.54.50.53.56.56.1626597517492.93',
'J:/1-5 Anonyme/2021/07/P302.052569/1.3.6.1.4.1.3167250.57.53.52.52.55.56.53.52.1626726978075.93',
'J:/1-5 Anonyme/2021/07/P302.056392/1.3.6.1.4.1.3167250.57.56.48.57.54.48.56.57.1627722426955.88',
'J:/1-5 Anonyme/2021/07/P302.053115/1.3.6.1.4.1.3167250.57.57.56.55.57.52.55.51.53.1626869287023',
'J:/1-5 Anonyme/2021/07/P302.056561/1.3.6.1.4.1.3167251.48.49.50.48.57.48.55.48.1627759323598.96',
'J:/1-5 Anonyme/2021/07/P302.052656/1.3.6.1.4.1.3167251.48.52.57.57.53.49.50.52.1626770237716.59',
'J:/1-5 Anonyme/2021/07/P302.053185/1.3.6.1.4.1.3167251.48.55.56.53.54.50.52.48.1626875635847.61',
'J:/1-5 Anonyme/2021/07/P302.052739/1.3.6.1.4.1.3167251.49.48.52.56.48.55.53.51.1626807276564.66',
'J:/1-5 Anonyme/2021/07/P302.052480/1.3.6.1.4.1.3167251.49.49.49.54.56.50.50.55.1626712486456.19',
'J:/1-5 Anonyme/2021/07/P302.052278/1.3.6.1.4.1.3167251.49.49.54.50.51.54.49.54.1626732322711.42',
'J:/1-5 Anonyme/2021/07/P302.052619/1.3.6.1.4.1.3167251.49.51.48.55.57.49.53.49.1626733945256.76',
'J:/1-5 Anonyme/2021/07/P302.052440/1.3.6.1.4.1.3167251.49.52.49.52.55.50.56.53.1626705125058.11',
'J:/1-5 Anonyme/2021/07/P302.052599/1.3.6.1.4.1.3167251.49.52.56.52.48.51.55.57.56.1627763097979',
'J:/1-5 Anonyme/2021/07/P302.054555/1.3.6.1.4.1.3167251.49.57.54.54.52.49.57.51.1627751818898.45',
'J:/1-5 Anonyme/2021/07/P302.048771/1.3.6.1.4.1.3167251.50.51.50.51.53.57.56.57.1625513897187.71',
'J:/1-5 Anonyme/2021/07/P302.056325/1.3.6.1.4.1.3167251.51.49.55.49.52.54.55.54.1627670441845.44',
'J:/1-5 Anonyme/2021/07/P302.053218/1.3.6.1.4.1.3167251.51.55.56.54.48.49.48.49.1626879016404.90',
'J:/1-5 Anonyme/2021/07/P302.053044/1.3.6.1.4.1.3167251.52.49.50.53.52.54.56.48.1626865510187.31',
'J:/1-5 Anonyme/2021/07/P302.052762/1.3.6.1.4.1.3167251.52.49.56.49.50.55.50.57.1626790682812.65',
'J:/1-5 Anonyme/2021/07/P302.052595/1.3.6.1.4.1.3167251.52.51.50.48.55.50.53.57.1626729388289.98',
'J:/1-5 Anonyme/2021/07/P302.052651/1.3.6.1.4.1.3167251.52.52.51.50.52.49.55.51.1626741471386.65',
'J:/1-5 Anonyme/2021/07/P302.052219/1.3.6.1.4.1.3167251.52.54.54.54.53.53.56.49.1626630885735.23',
'J:/1-5 Anonyme/2021/07/P302.048710/1.3.6.1.4.1.3167251.53.49.50.51.55.55.54.54.1625498071156.49',
'J:/1-5 Anonyme/2021/07/P302.052171/1.3.6.1.4.1.3167251.53.52.51.51.49.56.49.51.1626628124879.78',
'J:/1-5 Anonyme/2021/07/P302.052806/1.3.6.1.4.1.3167251.53.54.53.53.52.55.52.49.1626797778739.70',
'J:/1-5 Anonyme/2021/07/P302.052876/1.3.6.1.4.1.3167251.53.54.56.56.51.53.54.49.1626807750860.17',
'J:/1-5 Anonyme/2021/07/P302.052015/1.3.6.1.4.1.3167251.54.52.57.56.51.55.52.50.57.1626558072743',
'J:/1-5 Anonyme/2021/07/P302.053001/1.3.6.1.4.1.3167251.54.53.49.52.52.57.53.55.1626830300408.94',
'J:/1-5 Anonyme/2021/07/P302.052901/1.3.6.1.4.1.3167251.54.53.55.50.54.48.57.52.1626811420310.35',
'J:/1-5 Anonyme/2021/07/P302.052250/1.3.6.1.4.1.3167251.54.54.48.49.53.53.57.53.1626640896556.80',
'J:/1-5 Anonyme/2021/07/P302.052519/1.3.6.1.4.1.3167251.55.49.52.55.48.52.55.52.1626717698965.61',
'J:/1-5 Anonyme/2021/07/P302.051938/1.3.6.1.4.1.3167251.55.49.56.55.50.51.55.55.1626550099296.79',
'J:/1-5 Anonyme/2021/07/P302.052106/1.3.6.1.4.1.3167251.55.50.52.49.49.51.48.55.1626603026844.48',
'J:/1-5 Anonyme/2020/05/P302.013107/1.3.6.1.4.1.3167251.55.53.54.49.48.51.48.51.1590842607754.43',
'J:/1-5 Anonyme/2021/07/P302.056299/1.3.6.1.4.1.3167251.55.55.52.52.57.48.52.50.1627664633891.68',
'J:/1-5 Anonyme/2020/05/P302.013287/1.3.6.1.4.1.3167251.55.57.51.53.52.53.56.56.1590827865335.60',
'J:/1-5 Anonyme/2021/07/P302.048585/1.3.6.1.4.1.3167251.56.49.57.54.50.51.50.54.1625448484165.75',
'J:/1-5 Anonyme/2021/07/P302.052366/1.3.6.1.4.1.3167251.56.53.56.52.49.55.51.49.1626690520276.61',
'J:/1-5 Anonyme/2021/07/P302.051444/1.3.6.1.4.1.3167251.56.55.52.55.49.57.54.54.1626791078686.88',
'J:/1-5 Anonyme/2020/05/P302.013311/1.3.6.1.4.1.3167251.56.56.48.48.57.48.54.55.1590845102965.66',
'J:/1-5 Anonyme/2021/07/P302.052893/1.3.6.1.4.1.3167251.56.56.56.56.54.50.51.54.1626810343557.75',
'J:/1-5 Anonyme/2021/07/P302.051421/1.3.6.1.4.1.3167251.56.57.54.50.48.52.50.53.52.1626905807646',
'J:/1-5 Anonyme/2021/07/P302.052131/1.3.6.1.4.1.3167251.57.48.50.49.49.53.48.54.1626609515515.87',
'J:/1-5 Anonyme/2021/07/P302.052836/1.3.6.1.4.1.3167251.57.50.48.54.55.49.57.52.1626802483908.55',
'J:/1-5 Anonyme/2021/07/P302.052507/1.3.6.1.4.1.3167251.57.52.53.53.52.52.53.51.1626716378780.50',
'J:/1-5 Anonyme/2021/07/P302.052726/1.3.6.1.4.1.3167252.48.48.56.51.50.55.57.49.55.1626783480663',
'J:/1-5 Anonyme/2021/07/P302.052802/1.3.6.1.4.1.3167252.48.49.54.54.50.54.55.55.1626800812343.50',
'J:/1-5 Anonyme/2021/07/P302.056194/1.3.6.1.4.1.3167252.48.49.55.52.56.57.54.56.1627648151106.76',
'J:/1-5 Anonyme/2021/07/P302.048542/1.3.6.1.4.1.3167252.48.53.50.53.50.53.57.57.1625431696898.84',
'J:/1-5 Anonyme/2021/07/P302.048573/1.3.6.1.4.1.3167252.48.56.50.50.55.50.48.57.1625442599267.46',
'J:/1-5 Anonyme/2021/07/P302.053168/1.3.6.1.4.1.3167252.49.53.54.51.57.53.53.53.53.1626873288860',
'J:/1-5 Anonyme/2021/07/P302.048604/1.3.6.1.4.1.3167252.49.53.57.50.52.54.51.49.1625472182773.33',
'J:/1-5 Anonyme/2021/07/P302.053086/1.3.6.1.4.1.3167252.49.57.52.51.51.53.50.48.1626895947984.54',
'J:/1-5 Anonyme/2021/07/P302.051994/1.3.6.1.4.1.3167252.49.57.56.53.55.48.57.57.1626605750129.60',
'J:/1-5 Anonyme/2021/07/P302.052827/1.3.6.1.4.1.3167252.50.48.57.51.57.55.50.56.1626800998739.86',
'J:/1-5 Anonyme/2020/05/P302.013316/1.3.6.1.4.1.3167252.50.49.57.53.49.56.48.50.1590847219229.83',
'J:/1-5 Anonyme/2021/07/P302.052024/1.3.6.1.4.1.3167252.53.54.54.53.53.54.55.1626559958712.9.1',
'J:/1-5 Anonyme/2021/07/P302.052149/1.3.6.1.4.1.3167252.55.55.48.57.52.55.56.53.1626612186235.27',
'J:/1-5 Anonyme/2021/07/P302.052489/1.3.6.1.4.1.3167254.52.52.50.51.57.55.48.1626719370407.631',
'J:/1-5 Anonyme/2021/07/P302.052725/1.3.6.1.4.1.3167254.55.52.57.49.53.53.49.53.1626783371724.40',
'J:/1-5 Anonyme/2021/07/P302.050811/1.3.6.1.4.1.3167255.51.48.54.53.55.57.51.1626541596067.681',
'J:/1-5 Anonyme/2020/05/P302.013245/1.3.6.1.4.1.3167255.52.49.53.54.49.56.54.49.1590773303208.81',
'J:/1-5 Anonyme/2021/07/P302.052344/1.3.6.1.4.1.3167255.52.55.49.50.48.49.50.1626685011044.671',
'J:/1-5 Anonyme/2021/07/P302.052884/1.3.6.1.4.1.3167256.53.51.51.53.52.56.56.53.1626809699545.41',
'J:/1-5 Anonyme/2021/07/P302.051865/1.3.6.1.4.1.3167256.53.54.52.55.54.53.55.48.1626534900494.28',
'J:/1-5 Anonyme/2021/07/P302.052888/1.3.6.1.4.1.3167256.56.53.48.55.51.56.55.52.1626809719418.99',
'J:/1-5 Anonyme/2021/07/P302.053299/1.3.6.1.4.1.3167257.56.56.57.57.56.56.52.50.1626894380475.29']
# source_path = ['J:/test_nifti0/input']

# df = pd.read_csv('H:/2 OK/Global.csv', index_col=1, sep=';')
# df['Converted'] = False
# df['Convert Observation'] = ''
# for index, row in df.iterrows():
#     print(index)
#     try:
#         src = f'H:/2 OK/{index}'
#         des = f'J:/3 OK/{index}'
#         Path(des).mkdir(parents=True, exist_ok=True)
#         dicom2nifti.convert_directory(src, des, compression=True, reorient=True)
#         df.loc[index, 'Converted'] = True
#         df.loc[index, 'Methoed'] = 'Compression_Reorient'
#     except Exception:
#         df.loc[index, 'Convert Observation'] = Exception

#     df.to_csv('J:/3 OK/Global.csv', index=True, sep=';')


# df.to_csv('J:/3 OK/Global.csv', index=True, sep=';')


for src in source_path:
    print(src)
    try:
        des = src.replace('J:/1-5 Anonyme/','J:/1-5 Nii/')
        Path(des).mkdir(parents=True, exist_ok=True)
        dicom2nifti.convert_directory(src, des, compression=True, reorient=True)
    except Exception:
        print(Exception)

# for file in dirs:
#    print(file)

# for root, directories, files in os.walk(input_path, topdown=False):
#     for dir in directories:
#         print(os.path.join(root, dir))
#         print('---root:',root)
#         print('---dir :', dir)
# for file in files:
# print(os.path.join(root, file))
